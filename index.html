<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="generator" content="Hugo 0.79.0" />
        <title>  | Dmitry Rozhkov</title>
        <meta name="description" content="">
        <meta itemprop="name" content="">
        <meta itemprop="description" content="">
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200">
        <meta property="og:url" content="https://rojkov.github.io/">
        <meta property="og:site_name" content="Dmitry Rozhkov"><meta property="og:type" content="website">
        <link rel="icon" type="image/png" href="https://rojkov.github.io/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://rojkov.github.io/favicon-16x16.png" sizes="16x16">

	
	  <link href="/" rel="alternate" type="application/rss+xml" title="Dmitry Rozhkov" />
	  <link href="/" rel="feed" type="application/rss+xml" title="Dmitry Rozhkov" />
	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.47f9728fd974d375c7aef6b35f8ce489792802f8b4aede42526d18279fd04100.css">

        

        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav>

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://rojkov.github.io/page/about/">About</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Dmitry Rozhkov</a></h3>
            
        </div>

    <div class="languages">
                
                    
                        <a href="/en" class="active">en</a>
                    
                
                    
                        <a href="/ru">ru</a>
                    
                
            </div>
        

        
        <div class="toggler">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            



    

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/continuous-integration-in-maemo/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/continuous-integration-in-maemo/">Continuous Integration in Maemo</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2019-10-28</span>
            
        

        

        

        
    </div>

    
        <p>In the previous post about Maemo I made a quick review of its
human organization. Now I&rsquo;d like to add a couple of words about
its release process.</p>

        
            <a href="https://rojkov.github.io/posts/continuous-integration-in-maemo/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/how-maemo-products-were-developed/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/how-maemo-products-were-developed/">How Maemo Products Were Developed</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2019-10-21</span>
            
        

        

        

        
    </div>

    
        <p>Any project that goes beyond being a mere personal hobby is always a
collective effort where people work in concert. And these people
working in concert is the foundation on which any product is built.
Means of production are useless without people, but people need to
be organized, their relations have to be structured to transform
the collective effort into a meaningful outcome.</p>
<p>I used to be a part of the <a href="https://en.wikipedia.org/wiki/Maemo">Maemo</a>
project at Nokia. In this post I&rsquo;d like to write down what I still remember
about the ways the products like <a href="https://en.wikipedia.org/wiki/Nokia_N9">Nokia N9</a>
were developed.</p>

        
            <a href="https://rojkov.github.io/posts/how-maemo-products-were-developed/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer no-tags">


    

    
    <div class="languages">
        <i class="fa fa-language"></i>
        <div class="links">
            
                <a href="https://rojkov.github.io/ru/posts/how-maemo-products-were-developed/">ru</a>
            
        </div>
    </div>
    
</div>

</article>

        
    </div>

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/debugging-kubernetes-deployment/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/debugging-kubernetes-deployment/">Debugging a Kubernetes Deployment</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-09-09</span>
            
        

        

        

        
    </div>

    
        <p>When looking for a Kubernetes issue I could investigate I stumbled upon
this <a href="https://github.com/kubernetes/kubernetes/issues/67515">problem</a>.
The title should have been worded as something like «A new mysterious
<code>ReplicaSet</code> replaces the original one soon after its <code>Deployment</code> has
been created». What&rsquo;s important is that this new <code>ReplicaSet</code> fails
to start.</p>
<p>In hindsight the case seems rather trivial, but at the time I saw the
issue it didn&rsquo;t feel like that. The first suspect was the code of
Kubernetes mistakenly firing up an unneeded <code>ReplicaSet</code>, thus I needed
a way to hunt down the culprit in the code.</p>
<p>How do people debug such issues? Isn&rsquo;t there a proven methodology, a more
or less systematic approach to solving similar puzzles. I&rsquo;m not aware
of any. <a href="https://github.com/kubernetes/kubernetes/issues/67515#issuecomment-415481314">Not only me</a>
is asking such questions it seems. So, I decided to copy my comment
from the issue discussion to this blog.</p>

        
            <a href="https://rojkov.github.io/posts/debugging-kubernetes-deployment/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer no-tags">


    

    
    <div class="languages">
        <i class="fa fa-language"></i>
        <div class="links">
            
                <a href="https://rojkov.github.io/ru/posts/debugging-kubernetes-deployment/">ru</a>
            
        </div>
    </div>
    
</div>

</article>

        
    </div>

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/how-to-configure-devel-environment-to-work-on-gecko-for-sailfishos/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/how-to-configure-devel-environment-to-work-on-gecko-for-sailfishos/">How to Configure Devel Environment to Work on Gecko for Sailfishos</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2014-03-20</span>
            
        

        

        

        
    </div>

    
        <p>It turned out that newcomers have difficulties with setting up their development
environment to work on Gecko integration with Nemo, SailfishOS or any other
Mer-based Linux. Hence this post.</p>
<h3 id="configure-development-environment">Configure development environment</h3>
<p>Gecko engine development for embedded devices is quite resource consuming.
If you want to try it you&rsquo;d better have a mighty computer running Linux and
avoid virtualization. It&rsquo;s better not to use the standard SailfishOS SDK,
but to resort to Mer chroot-based SDK.</p>
<p>First of all you&rsquo;ll need to install Mer platform SDK and enter into it. Look at
<a href="https://wiki.merproject.org/wiki/Platform_SDK">this wiki page</a> for details and
follow the instructions till the part &ldquo;Basic tasks&rdquo;.</p>
<p>Then you&rsquo;ll need to create and install a rootfs. More detailed instructions
can be found <a href="https://wiki.merproject.org/wiki/Platform_SDK_and_SB2">here</a>,
but below is an extarct from there:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sudo mkdir -p /parentroot/srv/mer/targets
MerSDK$ <span style="color:#8be9fd;font-style:italic">cd</span> /tmp
</code></pre></div><p>Now in the current directory (which is /tmp) create a file <code>mer-target-armv7hl.ks</code>
with the following content:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#6272a4"># -*-mic2-options-*- --arch=armv7hl -*-mic2-options-*-</span>
lang en_US.UTF-8
keyboard us
timezone --utc UTC
part / --size <span style="color:#bd93f9">500</span> --ondisk sda --fstype<span style="color:#ff79c6">=</span>ext4
rootpw rootme

user --name mer  --groups audio,video --password rootme

repo --name<span style="color:#ff79c6">=</span>sailfish --baseurl<span style="color:#ff79c6">=</span>http://releases.jolla.com/releases/latest/jolla/armv7hl --save --debuginfo

%packages
glibc-devel
mesa-llvmpipe-libEGL-devel
mesa-llvmpipe-libGLESv2-devel
shadow-utils
rpm-build
meego-rpm-config
zypper
%end

%post
<span style="color:#6272a4">## rpm-rebuilddb.post from mer-kickstarter-configs package</span>
<span style="color:#6272a4"># Rebuild db using target&#39;s rpm</span>
<span style="color:#8be9fd;font-style:italic">echo</span> -n <span style="color:#f1fa8c">&#34;Rebuilding db using target rpm..&#34;</span>
rm -f /var/lib/rpm/__db*
rpm --rebuilddb
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;done&#34;</span>
<span style="color:#6272a4">## end rpm-rebuilddb.post</span>

<span style="color:#6272a4">## arch-armv7hl.post from mer-kickstarter-configs package</span>
<span style="color:#6272a4"># Without this line the rpm don&#39;t get the architecture right.</span>
<span style="color:#8be9fd;font-style:italic">echo</span> -n <span style="color:#f1fa8c">&#39;armv7hl-meego-linux&#39;</span> &gt; /etc/rpm/platform

<span style="color:#6272a4"># Also libzypp has problems in autodetecting the architecture so we force tha as well.</span>
<span style="color:#6272a4"># https://bugs.meego.com/show_bug.cgi?id=11484</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;arch = armv7hl&#39;</span> &gt;&gt; /etc/zypp/zypp.conf
<span style="color:#6272a4">## end arch-armv7hl.post</span>

%end
</code></pre></div><p>Then create a target:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sudo mic create fs mer-target-armv7hl.ks -o /parentroot/srv/mer/targets <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>                 --pkgmgr<span style="color:#ff79c6">=</span>zypp --arch<span style="color:#ff79c6">=</span>armv7hl --tokenmap<span style="color:#ff79c6">=</span>MER_RELEASE:latest
MerSDK$ sudo chown -R <span style="color:#8be9fd;font-style:italic">$USER</span> /parentroot/srv/mer/targets/mer-target-armv7hl/
</code></pre></div><p>Now tweak the target to recognize you:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ <span style="color:#8be9fd;font-style:italic">cd</span> /parentroot/srv/mer/targets/mer-target-armv7hl/
MerSDK$ grep :<span style="color:#ff79c6">$(</span>id -u<span style="color:#ff79c6">)</span>: /etc/passwd &gt;&gt; etc/passwd
MerSDK$ grep :<span style="color:#ff79c6">$(</span>id -g<span style="color:#ff79c6">)</span>: /etc/group &gt;&gt; etc/group
</code></pre></div><p>Configure it to work with Scratchbox2 together:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ <span style="color:#8be9fd;font-style:italic">cd</span> /parentroot/srv/mer/targets/mer-target-armv7hl/
MerSDK$ sb2-init -d -L <span style="color:#f1fa8c">&#34;--sysroot=/&#34;</span> -C <span style="color:#f1fa8c">&#34;--sysroot=/&#34;</span> <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>                 -c /usr/bin/qemu-arm-dynamic -m sdk-build -n -N <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>                 -t / mer-target-armv7hl <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>                 /opt/cross/bin/armv7hl-meego-linux-gnueabi-gcc
MerSDK$ sb2 -t mer-target-armv7hl -m sdk-install -R zypper ref --force
</code></pre></div><p>Clone web engine git repos to your local file system (e.g. into
the local directory <code>/home/rozhkov/tmp/mozilla-temp/</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mkdir -p /home/rozhkov/tmp/mozilla-temp
$ <span style="color:#8be9fd;font-style:italic">cd</span> /home/rozhkov/tmp/mozilla-temp
$ git clone git@github.com:tmeshkova/xulrunner-package.git
$ <span style="color:#8be9fd;font-style:italic">cd</span> xulrunner-package
$ ./pull.all.sh
</code></pre></div><p>After that install build requirements to the rootfs:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ <span style="color:#8be9fd;font-style:italic">cd</span> /home/rozhkov/tmp/mozilla-temp/xulrunner-package
MerSDK$ grep --color<span style="color:#ff79c6">=</span>never BuildRequires mozilla-central/rpm/xulrunner-qt5.spec | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        sed -e <span style="color:#f1fa8c">&#39;/^#.*$/d&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        gawk -F: <span style="color:#f1fa8c">&#39;{ print $2 }&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        tr <span style="color:#f1fa8c">&#39;,&#39;</span> <span style="color:#f1fa8c">&#39; &#39;</span>| <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        xargs sb2 -t mer-target-armv7hl -m sdk-install -R zypper in
MerSDK$ grep --color<span style="color:#ff79c6">=</span>never BuildRequires qtmozembed/rpm/qtmozembed-qt5.spec | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        sed -e <span style="color:#f1fa8c">&#39;/^#.*$/d&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        gawk -F: <span style="color:#f1fa8c">&#39;{ print $2 }&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        tr <span style="color:#f1fa8c">&#39;,&#39;</span> <span style="color:#f1fa8c">&#39; &#39;</span>| <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        xargs sb2 -t mer-target-armv7hl -m sdk-install -R zypper in
MerSDK$ grep --color<span style="color:#ff79c6">=</span>never BuildRequires embedlite-components/rpm/embedlite-components-qt5.spec | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        sed -e <span style="color:#f1fa8c">&#39;/^#.*$/d&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        gawk -F: <span style="color:#f1fa8c">&#39;{ print $2 }&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        tr <span style="color:#f1fa8c">&#39;,&#39;</span> <span style="color:#f1fa8c">&#39; &#39;</span>| <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        xargs sb2 -t mer-target-armv7hl -m sdk-install -R zypper in
MerSDK$ grep --color<span style="color:#ff79c6">=</span>never BuildRequires sailfish-browser/rpm/sailfish-browser.spec | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        sed -e <span style="color:#f1fa8c">&#39;/^#.*$/d&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        gawk -F: <span style="color:#f1fa8c">&#39;{ print $2 }&#39;</span> | <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        tr <span style="color:#f1fa8c">&#39;,&#39;</span> <span style="color:#f1fa8c">&#39; &#39;</span>| <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>        xargs sb2 -t mer-target-armv7hl -m sdk-install -R zypper in
</code></pre></div><p>Remove the packages that are not really needed for engine development:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-install -R <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>             zypper rm qtmozembed-qt5 qtmozembed-qt5-devel <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>                       xulrunner-qt5 xulrunner-qt5-devel
</code></pre></div><p>And finally build the stuff with the <code>build.sh</code> script::</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build ./build.sh -j -t mer
</code></pre></div><p>The option <code>-j</code> here makes <code>build.sh</code> build sailfish-browser binaries as well.</p>
<p>When everything is successfully built the script will show instructions on how
to run the newly built browser:</p>
<pre><code>...
make[1]: Leaving directory `/home/rozhkov/tmp/mozilla-temp/xulrunner-package/sailfish-browser/src'
make: Leaving directory `/home/rozhkov/tmp/mozilla-temp/xulrunner-package/sailfish-browser'

prepare run-time environment:
export LD_LIBRARY_PATH=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/src
export QML_IMPORT_PATH=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/qmlplugin5
export QML2_IMPORT_PATH=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/qmlplugin5

run unit-tests:
export QTTESTSROOT=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/tests
export QTTESTSLOCATION=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/tests/auto/mer-qt5
export QTMOZEMBEDOBJDIR=/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer
/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/tests/auto/run-tests.sh

run test example:
/home/rozhkov/tmp/mozilla-temp/xulrunner-package/objdir-mer/dist/bin/qmlMozEmbedTestQt5  -fullscreen  -url about:license
/home/rozhkov/tmp/mozilla-temp/xulrunner-package/objdir-mer/dist/bin/sailfish-browser about:license
</code></pre><p>Due to a bug in gecko build scripts you might encounter an error message about
missing <code>config.status</code> file after the build configuration phase. In this case
just copy the file <code>objdir-mer/config.status</code> to your working directory and
run <code>build.sh</code> again:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ cp objdir-mer/config.status .
MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build ./build.sh -j -t mer
</code></pre></div><p>The best way to test the build is to mount the working directory into the
device&rsquo;s file system so that the path to the built binaries on the device is
the same as in the host filesystem. For this you&rsquo;ll need to have the package
<code>sshfs</code> installed on the device:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#ff79c6">[</span>nemo@localhost-001 ~<span style="color:#ff79c6">]</span>$ mkdir tmp
<span style="color:#ff79c6">[</span>nemo@localhost-001 ~<span style="color:#ff79c6">]</span>$ sshfs rozhkov@192.168.2.14:/home/rozhkov/tmp tmp
<span style="color:#ff79c6">[</span>nemo@localhost-001 ~<span style="color:#ff79c6">]</span>$ devel-su
<span style="color:#ff79c6">[</span>root@localhost-001 nemo<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">cd</span> /home
<span style="color:#ff79c6">[</span>root@localhost-001 home<span style="color:#ff79c6">]</span>$ ln -s nemo rozhkov
<span style="color:#ff79c6">[</span>root@localhost-001 home<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">exit</span>
<span style="color:#ff79c6">[</span>nemo@localhost-001 ~<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">cd</span> tmp/mozilla-temp/xulrunner-package
<span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">LD_LIBRARY_PATH</span><span style="color:#ff79c6">=</span>/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/src
<span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">QML_IMPORT_PATH</span><span style="color:#ff79c6">=</span>/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/qmlplugin5
<span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">QML2_IMPORT_PATH</span><span style="color:#ff79c6">=</span>/home/rozhkov/tmp/mozilla-temp/xulrunner-package/qtmozembed/objdir-mer/qmlplugin5
<span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ /home/rozhkov/tmp/mozilla-temp/xulrunner-package/objdir-mer/dist/bin/sailfish-browser about:license
</code></pre></div><p>By now you should have working development environment. If you change code under
<code>mozilla-central/embedding/embedlite</code>, <code>qtmozembed</code>, <code>embedlite-components</code> or
<code>sailfish-browser</code> just run the <code>build.sh</code> script again:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build ./build.sh -j -t mer
</code></pre></div><p>If you change something inside other gecko components, e.g. under <code>mozilla-central/dom/events</code>
or <code>mozilla-central/gfx</code>,
then you&rsquo;ll need to rebuild the outdated object files too with the option <code>-o</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build ./build.sh -j -t mer -o dom/events,gfx
</code></pre></div><p>This way there is no need to rebuild all other object files. And if you&rsquo;re working
on the engine only then you might want to use the option <code>-e</code> of <code>build.sh</code> that
makes the script to rebuild only the engine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build ./build.sh -e -t mer
</code></pre></div><h3 id="useful-info">Useful info</h3>
<p>If you&rsquo;re working on JS components don&rsquo;t forget to reset the start up cache
before testing your work:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ rm -fr ~/.mozilla/mozembed/startupCache/
</code></pre></div><p>If you need to switch on <a href="https://wiki.mozilla.org/MailNews:Logging">logging</a>
in the engine then define <code>NSPR_LOG_MODULES</code> environment variable:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#ff79c6">[</span>nemo@localhost-001 xulrunner-package<span style="color:#ff79c6">]</span>$ <span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">NSPR_LOG_MODULES</span><span style="color:#ff79c6">=</span>TabChildHelper:5,EmbedLiteTrace:5,EmbedContentController:5
</code></pre></div><p>In order to see logging from components other than EmbedLite you&rsquo;d need to
have a so called debug build of xulrunner. Use the option <code>-d</code> of the
<code>build.sh</code> script to create it.</p>
<p>Unfortunately the gecko build system is based on python which runs under qemu
inside Scratchbox2 by default (unless you do x86 build). It is possible to accelerate python though.
To achieve this you need to use a special Scratchbox2 mode <code>sdk-build+pp</code> and
to add the option <code>-r</code> to <code>build.sh</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">MerSDK$ sb2 -t mer-target-armv7hl -m sdk-build+pp ./build.sh -r -j -t mer
</code></pre></div><p>Happy hacking!</p>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/embedlite-initialization/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/embedlite-initialization/">EmbedLite Initialization</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2014-03-02</span>
            
        

        

        

        
    </div>

    
        <p>I guess some people may find useful the couple of words below on how
EmbedLite embedding is initialized. I&rsquo;ve written them mostly because I&rsquo;m trying
to wrap my head around the topic myself. So please let me know if you see non-sense.</p>

        
            <a href="https://rojkov.github.io/posts/embedlite-initialization/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    
        
    <div class="article-wrapper u-cf">
        
            <a class="bubble" href="https://rojkov.github.io/posts/whats-behind-sailfish-browser/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://rojkov.github.io/posts/whats-behind-sailfish-browser/">What&#39;s Behind Sailfish Browser</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2014-02-09</span>
            
        

        

        

        
    </div>

    
        <p>In this post I&rsquo;d like to shade some light on what technology is used in
the browser application for Sailfish OS.</p>
<p>By now it&rsquo;s a widely known fact that the browser is based on the Gecko engine
which is developed by Mozilla corp. and is used in their Firefox browser and
Firefox OS. For some reason it&rsquo;s not that known that the Sailfish browser is
built upon the <a href="https://github.com/tmeshkova/gecko-dev/tree/embedlite/embedding/embedlite">EmbedLite</a>
embedding API (also known as IPCLiteAPI) for Gecko.</p>

        
            <a href="https://rojkov.github.io/posts/whats-behind-sailfish-browser/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    

    
    <div class="paginator">
        

        
    </div>



        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/continuous-integration-in-maemo/">Continuous Integration in Maemo</a>
                    </li>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/how-maemo-products-were-developed/">How Maemo Products Were Developed</a>
                    </li>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/debugging-kubernetes-deployment/">Debugging a Kubernetes Deployment</a>
                    </li>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/how-to-configure-devel-environment-to-work-on-gecko-for-sailfishos/">How to Configure Devel Environment to Work on Gecko for Sailfishos</a>
                    </li>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/embedlite-initialization/">EmbedLite Initialization</a>
                    </li>
                
                    <li>
                        <a href="https://rojkov.github.io/posts/whats-behind-sailfish-browser/">What&#39;s Behind Sailfish Browser</a>
                    </li>
                
                </ul>
        </div>
        

        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                
                
                
                
                
                
                
                
                
            </div>
            

            <div class="languages">
                    <strong>Other languages</strong>
                    
                        
                            <a href="/en" class="active">en</a>
                        
                    
                        
                            <a href="/ru">ru</a>
                        
                    
                </div>
            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/Lednerb" target="_blank">
                &copy;
                
                    2018
                
                by Lednerb
            </a>
	    -
		<a href="https://rojkov.github.io/index.xml">RSS</a>
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        

        


    </body>
</html>
